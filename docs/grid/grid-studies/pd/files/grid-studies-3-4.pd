#N canvas 306 409 869 646 10;
#X declare -lib OSC -lib mrpeach;
#X obj 182 71 serialosc;
#X obj 182 122 routeOSC /monome/grid/key;
#X text 385 159 x \, y \, state;
#X msg 385 183 \$2 \$1 \$3;
#X text 453 181 y \, x \, state;
#X obj 385 215 route 6 7;
#N canvas 272 344 608 821 toggles 0;
#X msg 37 117 \$3 \$2 \$1;
#X text 102 116 state \, x \, y;
#X obj 37 146 route 1;
#X text 92 145 if a key-down pass x \, y out left;
#X obj 70 253 * 16;
#X obj 37 228 unpack;
#X text 102 252 multiply y value by 16;
#X obj 37 279 +;
#X text 67 278 add x value to y*16;
#X floatatom 37 304 5 0 0 0 - - -;
#X text 78 303 this is our 'index' for the current key;
#X obj 37 763 tabwrite grid;
#X obj 37 426 tabread grid;
#X obj 37 389 t f f;
#X text 120 425 look up the stored value at the pressed index;
#X text 82 389 first set the index to write to \, and prepare to draw
an LED;
#X floatatom 37 457 5 0 0 0 - - -;
#X text 84 456 the stored state;
#X obj 37 485 == 0;
#X text 72 483 invert the stored state;
#X text 126 764 and write the new state to the table;
#X obj 284 577 / 16;
#X obj 284 602 int;
#X obj 246 623 % 16;
#X obj 227 657 pack f f f;
#X msg 227 683 \$2 \$3 \$1;
#X text 397 96 this is the table itself;
#X text 291 549 convert our index back into x \, y coordinates;
#X text 299 683 the send the value to the grid;
#X obj 37 36 inlet;
#X obj 227 708 outlet;
#X text 321 575 we divide by 16 to determine the row;
#X text 292 624 and use the remainder to determine the column;
#X obj 246 551 t f f;
#X text 274 707 x \, y \, state to serialosc;
#X text 78 36 y \, x \, state from the top 6 rows;
#X obj 459 73 table grid 128;
#X connect 0 0 2 0;
#X connect 2 0 5 0;
#X connect 4 0 7 1;
#X connect 5 0 7 0;
#X connect 5 1 4 0;
#X connect 7 0 9 0;
#X connect 9 0 13 0;
#X connect 12 0 16 0;
#X connect 13 0 12 0;
#X connect 13 1 11 1;
#X connect 13 1 33 0;
#X connect 16 0 18 0;
#X connect 18 0 11 0;
#X connect 18 0 24 0;
#X connect 21 0 22 0;
#X connect 22 0 24 2;
#X connect 23 0 24 1;
#X connect 24 0 25 0;
#X connect 25 0 30 0;
#X connect 29 0 0 0;
#X connect 33 0 23 0;
#X connect 33 1 21 0;
#X restore 436 256 pd toggles;
#X msg 436 289 /monome/grid/led/set \$1 \$2 \$3;
#X obj 436 321 s osc-out;
#X obj 182 27 r osc-out;
#X obj 91 202 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 91 232 metro;
#X floatatom 118 202 5 0 0 0 - - -;
#X text 156 202 ms interval;
#X obj 91 311 counter 0 15;
#X floatatom 91 351 5 0 0 0 - - -;
#X text 134 351 play position;
#X obj 91 396 t f b;
#X obj 91 496 s osc-out;
#X msg 118 430 /monome/grid/led/row 0 7 0 0;
#X msg 91 452 /monome/grid/led/set \$1 7 1;
#X obj 399 492 s osc-out;
#N canvas 1709 718 492 450 triggers 0;
#X obj 119 290 tabread grid;
#X obj 97 227 * 16;
#X obj 119 263 +;
#X obj 50 148 uzi 6;
#X obj 87 98 t b f;
#X obj 51 177 - 1;
#X obj 51 201 t f f;
#X obj 87 37 inlet;
#X obj 57 385 outlet;
#X text 130 36 current play position;
#X text 130 97 first store the x value to offset into the table;
#X text 104 146 uzi shoots out 6 numbers sequentially starting at 1
;
#X text 83 175 subtract 1 as the grid is '0 referenced';
#X text 96 200 first store the current uzi value representing the row
;
#X text 137 225 multiply by 16 to skip through the table by rows;
#X text 148 262 add the play position to the current row;
#X text 204 289 find the state at that index location;
#X text 104 385 send to serialosc for display;
#X obj 57 326 gate;
#X text 98 324 only send the location if the toggle is set;
#X connect 0 0 18 0;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 3 2 5 0;
#X connect 4 0 3 0;
#X connect 4 1 2 1;
#X connect 5 0 6 0;
#X connect 6 0 18 1;
#X connect 6 1 1 0;
#X connect 7 0 4 0;
#X connect 18 0 8 0;
#X restore 399 427 pd triggers;
#X msg 399 460 /monome/grid/led/set \$1 6 1;
#X obj 399 391 t f b;
#X msg 480 427 /monome/grid/led/level/row 0 6 5 5 5 5 5 5 5 5 5 5 5
5 5 5 5 5;
#X obj 281 558 dac~;
#N canvas 1342 80 539 406 tones 0;
#N canvas 1599 628 664 524 voice 0;
#X obj 81 159 mtof;
#X obj 80 275 *~;
#X obj 174 235 onepole~ 10;
#X obj 177 193 line~;
#X obj 98 57 inlet;
#X obj 177 57 inlet;
#X obj 82 343 outlet~;
#X obj 81 211 phasor~;
#X msg 176 161 1 \, 0 60;
#X connect 0 0 7 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 8 0;
#X connect 7 0 1 0;
#X connect 8 0 3 0;
#X restore 170 220 pd voice;
#N canvas 1599 628 664 524 voice 0;
#X obj 81 159 mtof;
#X obj 80 275 *~;
#X obj 174 235 onepole~ 10;
#X obj 177 193 line~;
#X obj 98 57 inlet;
#X obj 177 57 inlet;
#X obj 82 343 outlet~;
#X obj 81 211 phasor~;
#X msg 176 161 1 \, 0 60;
#X connect 0 0 7 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 8 0;
#X connect 7 0 1 0;
#X connect 8 0 3 0;
#X restore 229 218 pd voice;
#N canvas 1599 628 664 524 voice 0;
#X obj 81 159 mtof;
#X obj 80 275 *~;
#X obj 174 235 onepole~ 10;
#X obj 177 193 line~;
#X obj 98 57 inlet;
#X obj 177 57 inlet;
#X obj 82 343 outlet~;
#X obj 81 211 phasor~;
#X msg 176 161 1 \, 0 60;
#X connect 0 0 7 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 8 0;
#X connect 7 0 1 0;
#X connect 8 0 3 0;
#X restore 287 220 pd voice;
#N canvas 1599 628 664 524 voice 0;
#X obj 81 159 mtof;
#X obj 80 275 *~;
#X obj 174 235 onepole~ 10;
#X obj 177 193 line~;
#X obj 98 57 inlet;
#X obj 177 57 inlet;
#X obj 82 343 outlet~;
#X obj 81 211 phasor~;
#X msg 176 161 1 \, 0 60;
#X connect 0 0 7 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 8 0;
#X connect 7 0 1 0;
#X connect 8 0 3 0;
#X restore 346 219 pd voice;
#N canvas 1599 628 664 524 voice 0;
#X obj 81 159 mtof;
#X obj 80 275 *~;
#X obj 174 235 onepole~ 10;
#X obj 177 193 line~;
#X obj 98 57 inlet;
#X obj 177 57 inlet;
#X obj 82 343 outlet~;
#X obj 81 211 phasor~;
#X msg 176 161 1 \, 0 60;
#X connect 0 0 7 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 8 0;
#X connect 7 0 1 0;
#X connect 8 0 3 0;
#X restore 404 221 pd voice;
#X obj 42 123 loadbang;
#X obj 167 31 inlet;
#X obj 174 357 outlet~;
#X obj 166 61 sel 0 1 2 3 4 5;
#N canvas 1833 574 664 524 voice 0;
#X obj 81 159 mtof;
#X obj 80 275 *~;
#X obj 174 235 onepole~ 10;
#X obj 177 193 line~;
#X obj 98 57 inlet;
#X obj 177 57 inlet;
#X obj 82 343 outlet~;
#X obj 81 211 phasor~;
#X msg 176 161 1 \, 0 60;
#X connect 0 0 7 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 8 0;
#X connect 7 0 1 0;
#X connect 8 0 3 0;
#X restore 112 220 pd voice;
#X obj 177 285 *~ 0.5;
#X msg 107 177 35;
#X msg 167 178 38;
#X msg 294 178 49;
#X msg 407 177 61;
#X msg 347 176 54;
#X msg 234 176 45;
#X connect 0 0 10 0;
#X connect 1 0 10 0;
#X connect 2 0 10 0;
#X connect 3 0 10 0;
#X connect 4 0 10 0;
#X connect 5 0 11 0;
#X connect 5 0 12 0;
#X connect 5 0 16 0;
#X connect 5 0 13 0;
#X connect 5 0 15 0;
#X connect 5 0 14 0;
#X connect 6 0 8 0;
#X connect 8 0 9 1;
#X connect 8 1 0 1;
#X connect 8 2 1 1;
#X connect 8 3 2 1;
#X connect 8 4 3 1;
#X connect 8 5 4 1;
#X connect 9 0 10 0;
#X connect 10 0 7 0;
#X connect 11 0 9 0;
#X connect 12 0 0 0;
#X connect 13 0 2 0;
#X connect 14 0 4 0;
#X connect 15 0 3 0;
#X connect 16 0 1 0;
#X restore 281 528 pd tones;
#N canvas 1008 441 528 568 cutting 0;
#X obj 243 75 unpack;
#X obj 276 104 * 2;
#X obj 276 131 - 1;
#X obj 276 159 t b f;
#X obj 276 187 accum;
#X obj 210 223 gate 2;
#X obj 243 263 t b f;
#X obj 195 301 f;
#X msg 195 327 min \$1;
#X msg 270 368 max \$1;
#X msg 55 261 jam \$1;
#X obj 243 41 inlet;
#X obj 149 437 outlet;
#X text 105 260 set play position;
#X text 247 327 set loop start;
#X text 320 366 set loop end;
#X text 322 186 accumulate current held keys;
#X text 257 222 left if 1 key \, right if 2 keys held;
#X text 225 300 store the 1st press as a potential loop start;
#X text 38 520 http://monome.org;
#X text 38 503 grid studies 3-4-1;
#X connect 0 0 5 1;
#X connect 0 1 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 3 1 4 1;
#X connect 4 0 5 0;
#X connect 5 0 7 1;
#X connect 5 0 10 0;
#X connect 5 1 6 0;
#X connect 6 0 7 0;
#X connect 6 1 9 0;
#X connect 7 0 8 0;
#X connect 8 0 12 0;
#X connect 9 0 12 0;
#X connect 10 0 12 0;
#X connect 11 0 0 0;
#X restore 305 255 pd cutting;
#X text 508 255 toggle bank;
#X text 451 391 trigger events;
#X text 342 528 sounds;
#X text 28 585 grid studies 3-4;
#X text 28 602 http://monome.org;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 3 0 5 0;
#X connect 5 1 28 0;
#X connect 5 2 6 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 9 0 0 0;
#X connect 10 0 11 0;
#X connect 11 0 14 0;
#X connect 12 0 11 1;
#X connect 14 0 15 0;
#X connect 15 0 17 0;
#X connect 15 0 24 0;
#X connect 17 0 20 0;
#X connect 17 1 19 0;
#X connect 19 0 18 0;
#X connect 20 0 18 0;
#X connect 22 0 23 0;
#X connect 22 0 27 0;
#X connect 23 0 21 0;
#X connect 24 0 22 0;
#X connect 24 1 25 0;
#X connect 25 0 21 0;
#X connect 27 0 26 0;
#X connect 27 0 26 1;
#X connect 28 0 14 0;
